---
title: "projectdraft"
output: html_document
date: "2024-11-18"
---

```{r setup, include=FALSE}
library(tidyverse)
library(viridis)
library(plotly)
library(haven)
library(readr)
```

# Lisa: ADD Health Data 
```{r}
library(haven)
library(janitor)
library(dplyr)

w4data <- read_sas("w4inhome.sas7bdat") %>% 
  clean_names() %>% 
  mutate(
    first_gen = case_when(
      h4od4 == 0 ~ 1, 
      h4od4 == 1 ~ 0, 
      TRUE ~ NA_real_
    )
  )

first_gen_count <- w4data %>% 
  count(first_gen, name = "count")
print(first_gen_count)
```

# Nasiha: Hospital Data 

```{r}
hospital_data =
  read_csv(file = "./data/Hospitals.csv")

facilities_by_borough = 
  hospital_data %>%
  group_by(Borough) %>%
  summarise(Facility_Count = n())

hospitals_by_type = 
  hospital_data %>% 
  group_by(`Facility Type`) %>% 
  summarise(Facility_Count = n())

facility_type_by_borough =
  hospital_data %>%
  group_by(Borough, `Facility Type`) %>%
  summarise(Facility_Count = n(), .groups = "drop") %>%
  pivot_wider(names_from = `Facility Type`, values_from = Facility_Count, values_fill = 0)

ggplot(data = facilities_by_borough, aes(x = Borough, y = Facility_Count, fill = Borough)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "Number of Facilities by Borough", x = "Borough", y = "Facility Count")



```

# Yucheng: Shelter Data 

```{r}
as_df = read_csv("./data/asylum_seekers_report.csv") |> 
  janitor::clean_names() |> 
  filter(agency != "total") |> 
  mutate(category = ifelse(category == "Population - Individuals", "Individuals", category))

head(as_df)
```
```{r}
count_by_cat = as_df |> 
  group_by(category) |> 
  summarize(count_by_cat = sum(count, na.rm = TRUE), .groups = "drop")

ggplot(count_by_cat, aes(x = category, y = count_by_cat, fill = category)) +
  geom_col() +
  labs(title = "Total Counts of Asylum Seekers by Category", x = "Category", y = "Count") +
  scale_fill_viridis_d() +
  theme_minimal()
```
```{r}
counts_by_cat_agen = 
  ggplot(as_df, aes(x = category, y = count, fill = agency)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Counts by Category and Agency", x = "Category", y = "Count") +
  scale_fill_viridis_d() +
  theme_minimal()

ggplotly(counts_by_cat_agen)
```
